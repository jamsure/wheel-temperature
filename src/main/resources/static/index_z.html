
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <script>
        //IE 10 以下中问可能会乱码 不能读utf-8格式的文本
        function upload() {
            var Message = "请选择文件夹"; //选择框提示信息
            var Shell = new ActiveXObject( "Shell.Application" );
            var Folder = Shell.BrowseForFolder(0,Message,0x0040,0x11);//起始目录为：我的电脑
//var Folder = Shell.BrowseForFolder(0,Message,0); //起始目录为：桌面
            if(Folder != null){
                Folder = Folder.items(); // 返回 FolderItems 对象
                Folder = Folder.item(); // 返回 Folderitem 对象
                Folder = Folder.Path; // 返回路径
                if(Folder.charAt(Folder.length-1) != "\\"){
                    Folder = Folder + "\\";
                }
                document.all.savePath.value=Folder;
                return Folder;
            }
        }
    </script>
    <title>file upload</title>
</head>
<body>
<input type="file" onchange="upload(this)" />
</body>
</html>
